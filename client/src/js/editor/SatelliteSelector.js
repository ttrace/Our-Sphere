
ui.createSatelliteSelector = function() {
    var data = [
               {name: "ISS (ZARYA)             ", tle: "1 25544U 98067A   12129.91412265  .00008963  00000-0  13318-3 0  51872 25544  51.6425 318.7799 0010316 293.3223 208.1323 15.55960198771894"}, 
               {name: "TIANGONG 1              ", tle: "1 37820U 11053A   12129.72670105  .00039057  00000-0  26754-3 0  72392 37820  42.7852 291.1525 0011200 315.6831 121.9772 15.73946378 34971"}, 
               {name: "SOYUZ-TMA 03M           ", tle: "1 38036U 11078A   12128.55735399  .00008614  00000-0  12845-3 0  11932 38036  51.6419 325.5647 0010522 291.7701 164.8118 15.55921435771685"}, 
               {name: "AJISAI (EGS)            ", tle: "1 16908U 86061A   12128.88142666 -.00000083  00000-0  10000-3 0  85792 16908  50.0055 153.0611 0011229  24.4193 335.7173 12.44469795839051"}, 
               {name: "AKARI (ASTRO-F)         ", tle: "1 28939U 06005A   12129.49017535  .00005646  00000-0  32530-3 0  88742 28939  98.2645 151.4230 0176894  45.1422 316.4041 15.00517626330701"}, 
               {name: "ALOS (DAICHI)           ", tle: "1 28931U 06002A   12129.76184091  .00000470  00000-0  10758-3 0   1452 28931  98.0779 199.8875 0002326  81.6687 278.4760 14.59878068335024"}, 
               {name: "AQUA                    ", tle: "1 27424U 02022A   12128.71816413  .00000417  00000-0  10265-3 0  29702 27424  98.2033  69.9140 0001741  66.9156 293.2209 14.57122486532479"}, 
               {name: "ASTEX 1                 ", tle: "1 05560U 71089A   12129.49812775  .00000266  00000-0  73875-4 0  69722 05560  92.7118 323.1208 0016082 159.9989 200.1851 14.46588846131288"}, 
               {name: "ATLAS CENTAUR 2         ", tle: "1 00694U 63047A   12128.88299473  .00002113  00000-0  27901-3 0  89792 00694  30.3574 316.4679 0609750  97.1990 269.8293 13.96669056421020"}, 
               {name: "ATV-3 (EDOARDO AMALDI)  ", tle: "1 38096U 12010A   12128.55735399  .00008614  00000-0  12845-3 0   5002 38096  51.6419 325.5647 0010522 291.7701 164.8118 15.55921435771681"}, 
               {name: "INTERCOSMOS 24          ", tle: "1 20261U 89080A   12129.49892726  .00000577  00000-0  16379-3 0  75452 20261  82.5840 137.2395 1214182  73.4363 299.6344 12.53967092 31932"}, 
               {name: "INTERCOSMOS 25          ", tle: "1 21819U 91086A   12128.44109665  .00000874  00000-0  16464-3 0  73442 21819  82.5482 102.0102 1545147  87.0612 290.5521 12.00172073887874"}, 
               {name: "ENVISAT                 ", tle: "1 27386U 02009A   12129.71339020  .00000145  00000-0  62992-4 0  25212 27386  98.4750 198.7086 0001186  83.4264 276.7053 14.37502892533027"}, 
               {name: "ERBS                    ", tle: "1 15354U 84108B   12128.97114494  .00002937  00000-0  14966-3 0  93632 15354  56.9896 108.9103 0013791 185.9328 174.1539 15.19778728512263"}, 
               {name: "ERS-1                   ", tle: "1 21574U 91050A   12129.19799014  .00000296  00000-0  11503-3 0  33202 21574  98.2106 107.3050 0034302 139.1124 221.2651 14.36092951 89620"}, 
               {name: "ERS-2                   ", tle: "1 23560U 95021A   12129.54808639  .00002895  00000-0  22029-3 0  33912 23560  98.5063 235.7761 0005796  87.6527 272.5358 15.03029379893418"}, 
               {name: "GENESIS 1               ", tle: "1 29252U 06029A   12128.83736358  .00001687  00000-0  12485-3 0  63562 29252  64.5096 214.8476 0051575 246.7080 112.8605 15.05933332319688"}, 
               {name: "GENESIS 2               ", tle: "1 31789U 07028A   12129.83335988  .00001604  00000-0  12073-3 0  35502 31789  64.5081 244.4882 0051037 296.8689  62.7215 15.05501015267012"}, 
               {name: "HST                     ", tle: "1 20580U 90037B   12127.21007089  .00001384  00000-0  89465-4 0  99522 20580  28.4727  58.2270 0003137 331.6811  28.3610 15.02436937  8411"}, 
               {name: "ISIS 1                  ", tle: "1 03669U 69009A   12128.85371024  .00000073  00000-0  46020-4 0  42412 03669  88.4372 354.5627 1713248 196.7366 156.9613 11.28996786778329"}, 
               {name: "JB-3 2 (ZY 2B)          ", tle: "1 27550U 02049A   12129.74604326  .00008307  00000-0  25491-3 0  82952 27550  97.0710 124.9412 0008250  31.5904  85.6523 15.33953476530727"}, 
               {name: "KORONAS-FOTON           ", tle: "1 33504U 09003A   12129.86738744  .00001305  00000-0  84470-4 0  60602 33504  82.4753 274.4392 0017103  78.8172  72.8000 15.07233659179726"}, 
               {name: "METEOR PRIRODA          ", tle: "1 12585U 81065A   12128.67282697  .00001443  00000-0  93482-4 0  23132 12585  97.3038 143.4320 0020104  53.2015 307.1055 15.09479746679615"}, 
               {name: "MIDORI II (ADEOS-II)    ", tle: "1 27597U 02056A   12129.51398198  .00000140  00000-0  75086-4 0  72102 27597  98.3287 166.4529 0001917  67.8871 292.2514 14.26411320489366"}, 
               {name: "OAO 2                   ", tle: "1 03597U 68110A   12129.87032063  .00000143  00000-0  45731-4 0  89732 03597  34.9960 332.8684 0005036  78.8247 281.3009 14.45084063287871"}, 
               {name: "OAO 3 (COPERNICUS)      ", tle: "1 06153U 72065A   12128.67212699  .00000208  00000-0  50275-4 0   7152 06153  35.0083 201.1488 0007823 340.2210  19.8180 14.56868891108431"}, 
               {name: "OKEAN-3                 ", tle: "1 21397U 91039A   12128.91451469  .00001114  00000-0  11832-3 0  62692 21397  82.5211 105.7008 0019595 345.8674  14.1989 14.88034139131783"}, 
               {name: "OKEAN-O                 ", tle: "1 25860U 99039A   12129.41826053  .00000400  00000-0  68058-4 0  62122 25860  97.9318  92.8848 0001654  53.7341 306.4020 14.74177084688716"}, 
               {name: "OPS 8180 (RADCAT)       ", tle: "1 06212U 72076A   12129.53575244  .00094146  00000-0  82006-3 0  66122 06212  98.5693 326.0607 0002773 231.9335 128.1755 15.68716036285100"}, 
               {name: "ORBVIEW 2 (SEASTAR)     ", tle: "1 24883U 97037A   12129.89729598  .00000144  00000-0  68794-4 0  72682 24883  98.4126 249.5713 0001585 214.1806 145.9276 14.32445187784775"}, 
               {name: "PROGRESS-M 15M          ", tle: "1 38222U 12015A   12128.55735399  .00008614  00000-0  12845-3 0   3042 38222  51.6419 325.5647 0010522 291.7701 164.8118 15.55921435771682"}, 
               {name: "RESURS-DK 1             ", tle: "1 29228U 06021A   12129.73509780  .00000624  00000-0  58658-4 0  61712 29228  69.9349 155.0440 0006603 301.9516  58.0999 14.99391185328197"}, 
               {name: "SEASAT 1                ", tle: "1 10967U 78064A   12129.59441682  .00000076  00000-0  64036-4 0  70532 10967 108.0110   6.4815 0003164 260.2699  99.8089 14.42494483777487"}, 
               {name: "SERT 2                  ", tle: "1 04327U 70009A   12128.88121145  .00000032  00000-0  10000-3 0  47652 04327  99.1342 305.7730 0005059 125.3972 234.7642 13.58282368 94118"}, 
               {name: "SUZAKU (ASTRO-EII)      ", tle: "1 28773U 05025A   12128.94217579  .00002133  00000-0  14739-3 0  75532 28773  31.4055  53.7461 0005616 143.4384 216.6643 15.03509012375029"}, 
               {name: "COSMO-SKYMED 1          ", tle: "1 31598U 07023A   12129.79602168 -.00000078  00000-0 -32214-5 0  46542 31598  97.8686 315.6044 0001436  87.7174 272.4218 14.82157155266136"}, 
               {name: "COSMOS 1220             ", tle: "1 12054U 80089A   12129.19682118  .00021403  00000-0  52926-3 0  89162 12054  64.9676  95.3708 0019852  68.1814 292.1434 15.40288021629527"}, 
               {name: "COSMOS 1400             ", tle: "1 13402U 82079A   12128.88653803  .00008267  00000-0  22195-3 0  67352 13402  81.1272 303.1193 0007351 115.4523 244.7496 15.37762926630801"}, 
               {name: "COSMOS 1484             ", tle: "1 14207U 83075A   12128.67565159  .00028139  00000-0  24863-3 0  22012 14207  97.6297 321.0830 0008368 327.1203  32.9536 15.68600482 25034"}, 
               {name: "COSMOS 1500             ", tle: "1 14372U 83099A   12128.95067779  .00002131  00000-0  14155-3 0  97162 14372  82.5320  12.4265 0015046  27.4406 332.7611 15.06631394555712"}, 
               {name: "COSMOS 1536             ", tle: "1 14699U 84013A   12129.53349045  .00001206  00000-0  95958-4 0  45482 14699  82.5254 328.8380 0012299 279.0250  80.9564 14.99521894532933"}, 
               {name: "COSMOS 1544             ", tle: "1 14819U 84027A   12129.52612178  .00002748  00000-0  16291-3 0  35612 14819  82.4916  81.7837 0021490  56.0391 304.2875 15.10788487532647"}, 
               {name: "COSMOS 1812             ", tle: "1 17295U 87003A   12129.14480786  .00001235  00000-0  85387-4 0  75622 17295  82.5260 167.5461 0013994  49.2094 311.0341 15.04786636377357"}, 
               {name: "COSMOS 1833             ", tle: "1 17589U 87027A   12129.46881320 -.00000303  00000-0 -13738-3 0  15922 17589  70.9128 145.4210 0005875  16.2801 343.8515 14.12781567296793"}, 
               {name: "COSMOS 1844             ", tle: "1 17973U 87041A   12129.51800782 -.00000266  00000-0 -11454-3 0  18322 17973  70.8934 244.8771 0029404  42.8479 317.4926 14.13801105289438"}, 
               {name: "COSMOS 1867             ", tle: "1 18187U 87060A   12129.16292739 -.00000079  00000-0  82085-5 0  45632 18187  65.0100  50.5233 0013289 270.2235  89.7327 14.30924583296991"}, 
               {name: "COSMOS 1933             ", tle: "1 18958U 88020A   12129.90646455  .00000983  00000-0  80615-4 0  64442 18958  82.5286  97.2792 0014420 120.5287 239.7318 14.98097148311735"}, 
               {name: "COSMOS 1953             ", tle: "1 19210U 88050A   12129.22899531  .00001453  00000-0  11924-3 0  75402 19210  82.5211  33.9524 0017663 114.2025 246.1057 14.98391931297694"}, 
               {name: "COSMOS 1975             ", tle: "1 19573U 88093A   12129.14408023  .00001242  00000-0  10520-3 0  52662 19573  82.5235 341.7210 0018043 136.1676 224.0980 14.97031744279896"}, 
               {name: "COSMOS 2058             ", tle: "1 20465U 90010A   12128.85740810  .00001276  00000-0  12192-3 0  44652 20465  82.4927 235.6351 0019418  79.3056 281.0348 14.92336408206452"}, 
               {name: "COSMOS 2084             ", tle: "1 20663U 90055A   12129.53402429  .00001389  00000-0  15252-3 0  46912 20663  62.7939 313.3937 0128481 128.8227 232.4421 14.86885206181914"}, 
               {name: "COSMOS 2151             ", tle: "1 21422U 91042A   12129.19379411  .00000577  00000-0  59275-4 0  24742 21422  82.5028 217.9914 0016738  36.4429 323.7930 14.88508191130572"}, 
               {name: "COSMOS 2228             ", tle: "1 22286U 92094A   12129.51193169  .00000692  00000-0  79913-4 0  68672 22286  82.5188 328.7854 0021842 173.8408 186.3102 14.84038480 45414"}, 
               {name: "COSMOS 2242             ", tle: "1 22626U 93024A   12129.19414279  .00000631  00000-0  72389-4 0  45032 22626  82.5242 356.6931 0019964 174.4268 185.7173 14.84167952 29018"}, 
               {name: "COSMOS 2278             ", tle: "1 23087U 94023A   12128.85693401  .00000369  00000-0  22124-3 0  77632 23087  71.0513 298.7455 0009371 188.9460 171.1492 14.13455771930752"}, 
               {name: "COSMOS 2428             ", tle: "1 31792U 07029A   12129.79559306  .00000138  00000-0  10000-3 0  39442 31792  71.0073   1.0426 0009111 219.5496 187.9651 14.12498500250685"}, 
               {name: "COSMOS 482 DESCENT CRAFT", tle: "1 06073U 72023E   12129.62962490  .00014080  33594-5  94722-4 0  97802 06073  52.1124 189.9492 2031903 290.6365 252.4089 11.55682510135096"}
    ];


    return {
        xtype: 'satellitelist',
        satellites: data,
        flex: 1,
        listeners: {
            satelliteselect: ui.handleSatelliteSelect
        }
    };
}

ui.handleSatelliteSelect = function(view, records) {
    var selectedNames = {};
    records.forEach(function(r) {
        var d = r.data;
        if (!op.satellites[d.name]) {
            var tle = [];
            tle.push(r.data.tle.substring(0, 69));
            tle.push(r.data.tle.substring(69));
            var mySat = new op.oursatellite(d.name, tle);
            mySat.build();

            // Retain reference
            op.satellites[d.name] = mySat;
        }
        selectedNames[d.name] = true;
    });

    Object.keys(op.satellites).forEach(function(name) {
        if (!selectedNames[name]) {
            op.satellites[name].destroy();
            delete op.satellites[name];
        }
    });
}
