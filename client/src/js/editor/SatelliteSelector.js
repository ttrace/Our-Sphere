
ui.createSatelliteSelector = function() {
    var data = [
          {name: "ISS (ZARYA)", tle: "1 25544U 98067A   12112.38843948  .00021123  00000-0  27640-3 0  41582 25544  51.6432  46.5756 0007816 300.1368 157.1612 15.58536646769160"},
          {name: "TIANGONG(天宮)", tle: "1 37820U 11053A   12112.09993056  .00046612  00000-0  34100-3 0  67262 37820  42.7849  38.1579 0009495 203.7193   0.2915 15.72368859 32197"},
          {name: "ATLAS CENTAUR 2", tle: "1 00694U 63047A   12111.86870588  .00001422  00000-0  17991-3 0  88142 00694  30.3637  49.2756 0610608 310.7873  44.1322 13.96588406418645"},
          {name: "OAO 2", tle: "1 03597U 68110A   12111.35307615  .00000140  00000-0  44755-4 0  88322 03597  34.9938  75.8823 0006049 300.8474  59.1620 14.45075367285190"},
          {name: "ISIS 1", tle: "1 03669U 69009A   12110.86163112  .00000023  00000-0  15708-4 0  40192 03669  88.4419 356.5478 1712151 232.9941 110.2118 11.28993970776290"},
          {name: "Hubble Space Telescope", tle: "1 20580U 90037B   12112.19720777  .00001785  00000-0  11912-3 0  98652 20580  28.4690 156.4620 0003503 171.3463 188.7203 15.02389325  6155"},
          {name: "METEOR 1-1", tle: "1 03835U 69029A   12086.76135367  .25198191 -97535-6  25232-3 0  14072 03835  81.1165 230.5329 0011418 263.0265  97.6822 16.50605120355155"},
          {name: "SERT 2", tle: "1 04327U 70009A   12110.90789868  .00000032  00000-0  10000-3 0  47722 04327  99.1323 289.0535 0004597 171.3817 188.7405 13.58280518 91677"},
          {name: "ASTEX 1", tle: "1 05560U 71089A   12111.65146114  .00000260  00000-0  72341-4 0  68232 05560  92.7129 317.3925 0014232 225.5032 134.5009 14.46576377128709"},
          {name: "OAO 3 (COPERNICUS)", tle: "1 06153U 72065A   12110.92178144  .00000206  00000-0  49861-4 0   3682 06153  35.0087 301.7719 0006603 202.1836 157.8573 14.56857743105849"},
          {name: "OPS 8180 (RADCAT)", tle: "1 06212U 72076A   12111.78284614  .00098996  00000-0  10029-2 0  63952 06212  98.5725 304.4252 0001749 260.3579  99.7726 15.64937080282322"},
          {name: "SEASAT 1", tle: "1 10967U 78064A   12112.25738302  .00000112  00000-0  74811-4 0  69022 10967 108.0113 330.3280 0002951 266.7772  93.3034 14.42483848774985"},
          {name: "COSMOS 1220", tle: "1 12054U 80089A   12112.24638271  .00019896  00000-0  50639-3 0  87262 12054  64.9696 151.7460 0020057  79.3596 280.9802 15.39438283626910"},
          {name: "METEOR PRIRODA", tle: "1 12585U 81065A   12111.76845566  .00002688  00000-0  17125-3 0  20132 12585  97.3028 127.3303 0019809 106.6273 253.7126 15.09394102677069"},
          {name: "ERBS", tle: "1 15354U 84108B   12112.26313987  .00004577  00000-0  22612-3 0  92312 15354  56.9826 178.2956 0015157 159.6975 200.4653 15.19637744509725"},
          {name: "AJISAI (EGS)", tle: "1 16908U 86061A   12112.25725432 -.00000083  00000-0  10000-3 0  80212 16908  50.0098 204.1752 0011086 341.7413  18.3022 12.44469386836985"},
          {name: "INTERCOSMOS 24", tle: "1 20261U 89080A   12111.22745016  .00000480  00000-0  13453-3 0  73922 20261  82.5868 149.0371 1214205 115.4150 257.7538 12.53945012 29647"}
    ];


    return {
        xtype: 'satellitelist',
        satellites: data,
        flex: 1,
        listeners: {
            satelliteselect: ui.handleSatelliteSelect
        }
    };
}

ui.handleSatelliteSelect = function(view, records) {
    var selectedNames = {};
    records.forEach(function(r) {
        var d = r.data;
        if (!op.satellites[d.name]) {
            var tle = [];
            tle.push(r.data.tle.substring(0, 69));
            tle.push(r.data.tle.substring(69));
            var mySat = new op.oursatellite(d.name, tle);
            mySat.build();

            // Retain reference
            op.satellites[d.name] = mySat;
        }
        selectedNames[d.name] = true;
    });

    Object.keys(op.satellites).forEach(function(name) {
        if (!selectedNames[name]) {
            op.satellites[name].destroy();
            delete op.satellites[name];
        }
    });
}
